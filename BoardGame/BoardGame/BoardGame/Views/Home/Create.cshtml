@using WebMatrix.Data

@{
    var db = Database.Open("BoardGame");

    var maxIdQuery = "SELECT ISNULL(MAX(BGGID), 0) AS MaxId FROM BOARDGAME";
    var maxIdResult = db.QuerySingle(maxIdQuery);
    int newBggId = maxIdResult.MaxId + 1;

    if (IsPost)
    {
        var isql = @"INSERT INTO BOARDGAME
(BGGID, Name, Description, YearPublished, GameWeight, MinPlayers, MaxPlayers, ComAgeRec, LanguageEase, BestPlayers)
VALUES (@0, @1, @2, @3, @4, @5, @6, @7, @8, @9)";
        var rsql = @"INSERT INTO GameFamily (FamilyCode, Family) values (@0, @1)";

        var idata = db.Execute(isql,
            newBggId,
            Request.Form["bName"],
            Request.Form["bDescription"],
            Convert.ToDateTime(Request.Form["bYearPublished"] + "-01-01"),
            Convert.ToDouble(Request.Form["bGameWeight"]),
            Convert.ToByte(Request.Form["bMinPlayers"]),
            Convert.ToInt32(Request.Form["bMaxPlayers"]),
            Convert.ToDouble(Request.Form["bComAgeRec"]),
            Convert.ToDouble(Request.Form["bLanguageEase"]),
            Convert.ToByte(Request.Form["bBestPlayers"])
        );
        if (idata == 1)
        {
            var newID = db.GetLastInsertId();
            Response.Redirect("Details?id=" + newBggId);
        }
    }
}


    <form action="Create" method="post">
        <div>
            Name
            <input type="text" placeholder="fill the game name" name="bName" />
            Decription
            <input type="text" placeholder="fill the game description" name="bDescription" />
            Year
            <input type="number" placeholder="fill the game year" name="bYearPublished" />
            GameWeight
            <input type="number" placeholder="fill the game weight" name="bGameWeight" />
            MinPlayers
            <input type="number" placeholder="fill the minimum players" name="bMinPlayers" />
            MaxPlayers
            <input type="number" placeholder="fill the maximum players" name="bMaxPlayers" />
            ComAgeRec
            <input type="number" placeholder="fill the recommended age" name="bComAgeRec" />
            LanguageEase
            <input type="text" placeholder="fill the language ease" name="bLanguageEase" />
            BestPlayers
            <input type="text" placeholder="fill the best players" name="bBestPlayers" />

            GameFamily
            <input type="text" placeholder="fill the game family" name=""

            <input type="submit" value="save" />
            <button type="reset">Clear</button>
        </div>
    </form>